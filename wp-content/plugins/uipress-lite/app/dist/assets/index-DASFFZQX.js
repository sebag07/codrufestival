import{b as u,w as A,g as d,q as k,k as c,j as M,m as j,F as f,f as B,o as p,t as e,y as s,D as S,l as F,u as l,z as h,ac as V,E as G,a6 as W}from"./index-COn-5JHg.js";import{u as z}from"../builder.build.DfBdCMNY.js";import{_ as H}from"./index-DvmIT408.js";/* empty css              */const I={class:"inline-flex uip-text-muted"},J={class:"uip-max-w-200 uip-overflow-hidden uip-text-ellipsis uip-no-wrap"},O={class:"inline-flex uip-text-muted"},R={class:"uip-flex uip-flex-column uip-gap-s"},U={class:"grid grid-cols-6 gap-4"},X={class:"uip-text-muted"},q={class:"col-span-5 flex flex-row place-content-between"},K={class:"uip-text-muted"},Q={class:"col-span-5"},Y={class:"uip-text-muted"},Z={class:"col-span-5"},ee={class:"uip-text-muted"},te={class:"col-span-5"},se={class:"uip-text-muted"},ie={class:"col-span-5"},ae={class:"uip-text-muted"},oe={class:"col-span-5"},ne=["innerHTML"],re={class:"uip-text-muted"},le={class:"col-span-5 uip-flex uip-flex-column uip-gap-s"},ge={__name:"index",setup(ue){const{__:i}=wp.i18n,m=u([]),a=u(null),y=u(null),x=u(!0);u(null),z();const{appContext:T}=W(),r=u({search:"",per_page:15,page:1,total:0,pages:0,status:"any",context:"edit"}),N=u([{key:"time",label:i("Time","uipress-lite")},{key:"status",label:i("Status","uipress-lite")},{key:"message",label:i("Message","uipress-lite")},{key:"date",label:i("Date","uipress-lite")}]),v=async n=>{const{uipApp:t}=T.config.globalProperties;x.value=!0;const{per_page:_,search:o,page:w}=r.value,L=`${uip_ajax.rest_url}uipress/v1/errorlog?per_page=${_}&search=${o}&page=${w}`,g=await fetch(L,{method:"GET",headers:uip_ajax.rest_headers});if(x.value=!1,!g.ok){t.notifications.notify(i("Unable to fetch error list right now"),"","error",!0);return}const $=await g.json();if(g.error){t.notifications.notify(i("Unable to fetch error list right now"),"","error",!0);return}r.value.total=g.headers.get("X-WP-Total"),r.value.pages=g.headers.get("X-WP-TotalPages"),m.value=$},C=n=>{try{return JSON.stringify(JSON.parse(n),void 0,2)}catch{return n}},E=()=>{r.value.page>1&&(r.value.page--,v())},P=()=>{r.value.page<r.value.pages&&(r.value.page++,v())},D=(n,t)=>{a.value=m.value[t],a.value&&y.value.show()},b=n=>n=="MESSAGE"?"uip-border-green uip-text-green":n=="FATAL"?"uip-border-red uip-text-red":n=="WARNING"?"uip-border-orange uip-text-orange":"uip-border uip-text-muted";return A(()=>r.value.search,(n,t)=>{!n&&t&&v()}),v(),(n,t)=>{const _=B("uip-offcanvas");return p(),d(f,null,[k(H,{pagination:r.value,columns:N.value,data:m.value,fetching:x.value,onPrevious:E,onNext:P,onSearch:t[0]||(t[0]=o=>v()),rowClick:D,hideSelect:!0},{"row-time":c(({row:o})=>[e("div",I,"@"+s(o.time),1)]),"row-status":c(({row:o})=>[e("div",{class:S(["uip-inline-flex uip-text-s uip-padding-left-xxs uip-padding-right-xxs uip-border uip-border-round uip-font-mono",b(o.type)])},s(o.type),3)]),"row-message":c(({row:o})=>[e("div",J,s(o.message),1)]),"row-date":c(({row:o})=>[e("div",O,s(o.date),1)]),_:1},8,["pagination","columns","data","fetching"]),(p(),M(j("style"),null,{default:c(()=>t[1]||(t[1]=[F(" .gap-4 { gap: 1rem; } .grid-cols-6 { grid-template-columns: repeat(6, minmax(0px, 1fr)); } .grid { display: grid; }.col-span-5 { grid-column: span 5 / span 5; } .col-span-6 { grid-column: span 6 / span 6; } .text-pretty { text-wrap: pretty; }")])),_:1})),k(_,{ref_key:"offcanvas",ref:y,style:{width:"560px"}},{content:c(()=>[e("div",R,[e("div",U,[e("div",X,s(l(i)("Status","uipress-lite")),1),e("div",q,[e("div",{class:S(["uip-inline-flex uip-text-s uip-padding-left-xxs uip-padding-right-xxs uip-border uip-border-round uip-font-mono",b(a.value.type)])},s(a.value.type),3)]),t[5]||(t[5]=e("div",{class:"uip-border-top col-span-6"},null,-1)),a.value.file?(p(),d(f,{key:0},[e("div",K,[e("div",null,s(l(i)("File","uipress-lite")),1)]),e("div",Q,s(a.value.file),1),t[2]||(t[2]=e("div",{class:"uip-border-top col-span-6"},null,-1))],64)):h("",!0),a.value.line?(p(),d(f,{key:1},[e("div",Y,s(l(i)("Line","uipress-lite")),1),e("div",Z,"@"+s(a.value.line),1),t[3]||(t[3]=e("div",{class:"uip-border-top col-span-6"},null,-1))],64)):h("",!0),e("div",ee,s(l(i)("Date","uipress-lite")),1),e("div",te,s(l(V)(a.value.date)),1),t[6]||(t[6]=e("div",{class:"uip-border-top col-span-6"},null,-1)),e("div",se,s(l(i)("Time","uipress-lite")),1),e("div",ie,"@"+s(a.value.time),1),t[7]||(t[7]=e("div",{class:"uip-border-top col-span-6"},null,-1)),e("div",ae,[e("div",null,s(l(i)("Message","uipress-lite")),1)]),e("div",oe,[e("pre",{innerHTML:C(a.value.message),class:"text-pretty",style:{margin:"0"}},null,8,ne)]),t[8]||(t[8]=e("div",{class:"uip-border-top col-span-6"},null,-1)),a.value.stackTrace.length?(p(),d(f,{key:2},[e("div",re,[e("div",null,s(l(i)("Stack trace","uipress-lite")),1)]),e("div",le,[(p(!0),d(f,null,G(a.value.stackTrace,(o,w)=>(p(),d("div",null,s(o),1))),256))]),t[4]||(t[4]=e("div",{class:"uip-border-top col-span-6"},null,-1))],64)):h("",!0)])])]),_:1},512)],64)}}};export{ge as default};
//# sourceMappingURL=index-DASFFZQX.js.map
